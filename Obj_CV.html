<!doctype html>
<html class="no-js" lang="en">
<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="http://kushalvyas.github.io/theme/css/materialize.min.css">
        <!-- <link rel="stylesheet" type="text/css" href=""> -->
        <script src="http://kushalvyas.github.io/theme/js/jquery-1.11.3.min.js"></script>
        <script src="http://kushalvyas.github.io/theme/js/materialize.min.js"></script>
        <link rel="stylesheet" href="http://kushalvyas.github.io/theme/css/foundation.min.css" media="all">
        <script type="text/javascript" src="http://kushalvyas.github.io/theme/js/modernizr.js"></script>
        <link href='https://fonts.googleapis.com/css?family=Exo+2:400,300,700,300italic,400italic,700italic,900,900italic' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" type="text/css" href="http://kushalvyas.github.io/theme/css/font-awesome.min.css">
        <link rel="stylesheet" type="text/css" href="http://kushalvyas.github.io/theme/css/pygments.min.css">
        <link rel="stylesheet" type="text/css" href="http://kushalvyas.github.io/theme/css/subscribe.css">
        <!-- <script src="http://kushalvyas.github.io/theme/syntax/scripts/shAutoloader.js" type="text/javascript"></script> -->
        <!-- <link href="http://kushalvyas.github.io/theme/syntax/styles/shCore.css" rel="stylesheet" type="text/css" /> -->
        <!-- <link href="http://kushalvyas.github.io/theme/syntax/styles/shThemeRDark.css" rel="stylesheet" type="text/css" /> -->
        <!-- <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"> -->
        <link rel="stylesheet" href="http://kushalvyas.github.io/theme/css/lamboz.css" media="all">
        <title>Simple Object Recognition&nbsp;techniques - BitsMakeMeCrazy | Kushal Vyas's Blog</title>
        <meta charset="utf-8" />
        <link href="http://kushalvyas.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="BitsMakeMeCrazy | Kushal Vyas's Blog Full Atom Feed" />
        <link href="http://kushalvyas.github.io/feeds/object-recognitioncv.atom.xml" type="application/atom+xml" rel="alternate" title="BitsMakeMeCrazy | Kushal Vyas's Blog Categories Atom Feed" />
  

        <script src="//load.sumome.com/" data-sumo-site-id="cecf6965e36602158241ee45155d77c8c02f27706e5178b61597811ab112b3a8" async="async"></script>   

       
</head>
<body>
    <div class="pages">
        <ul>
            <li class="home"><a href="http://kushalvyas.github.io/index.html">Home</a></li>
            <li ><a href="http://kushalvyas.github.io/pages/about-me.html">About&nbsp;me</a></li>
            <li ><a href="http://kushalvyas.github.io/pages/technical.html">Computer&nbsp;Vision</a></li>
            <li ><a href="http://kushalvyas.github.io/pages/projects.html">Projects</a></li>
            <li ><a href="http://kushalvyas.github.io/pages/Music.html">Music</a></li>

            <li style="float :right;" class=""><a href="http://www.github.com/kushalvyas" target="_blank"><i class="fa fa-github fa-2x" aria-hidden='true'></i>&nbsp;&nbsp;</a></li>
            <li style="float :right;" class=""><a href="mailto:kushalvyaskv@gmail.com" target="_blank"><i class="fa fa-envelope-o fa-2x" aria-hidden='true'></i>&nbsp;&nbsp;</a></li>
            <li style="float :right;" class=""><a href="https://twitter.com/kushal_kv" target="_blank"><i class="fa fa-twitter fa-2x" aria-hidden='true'></i>&nbsp;&nbsp;</a></li>
            <li style="float :right;" class=""><a href="https://www.youtube.com/channel/UCoAFKWmi3Wca8hj5GSEriRQ" target="_blank"><i class="fa fa-youtube fa-2x" aria-hidden='true'></i>&nbsp;&nbsp;</a></li>
        </ul>
    </div>
<div class="hp-header-inner">
    <div class="page-header">
        <div class="content-header">
            <div id="title-block">
            <h1>  <a href="http://kushalvyas.github.io/Obj_CV.html" rel="bookmark"
                    title="Permalink to Simple Object Recognition techniques">Simple Object Recognition&nbsp;techniques</a></h1>
            </div>
        </div>
    </div>
</div>
    <div class="content">
        <div class="data-holder">
        <div class="row">
           <div class="large-10 content-column column">
<div class="content-article">
    <header class="header-article">
        <div class="read-more">Posted on Wed 13 July 2016</div>
 
   </header>
    <section class='article'>
        
        <div class="entry-summary">
            <p>A brief introduction on object recognition techniques in  <span class="caps">CV</span></p>
        </div>
    
        <div class="entry-content">
            <p>Object recognition is one of the hot topics in computer vision. Particularly, of much significance, it has various applications in robotics, identification, interpretation and such image oriented&nbsp;tasks. </p>
<p>One can ramify between Object recognition into 4 major subsets such as&nbsp;:</p>
<ol>
<li>
<p><strong>Template based approach</strong> : We take the object and match the object with distribution pattern of intensities. It&#8217;s quite exhaustive is not invariant to geometric transformations inside search image
    Eg: Template Matching . However, this isint much&nbsp;sturdy.</p>
</li>
<li>
<p><strong>Geometric approach</strong> : Recognize the object on basis of edges, corners, angles. Then we create a one 2  one match and then make a transformation that handles rotation, scaling, etx.<br />
    Eg: Matching w.r.t positioning of objects. Classifying&nbsp;patterns</p>
</li>
<li>
<p><strong>Graph based approach</strong> : we match similar types of structures. Encode the relationship between structures rather than the geometry of the&nbsp;figure.  </p>
</li>
<li>
<p><strong>Bag of Visual Words</strong> : I will cover Bag of Words in a seperate post <a href="http://kushalvyas.github.io/BOV.html">Bag of Words</a>.</p>
</li>
</ol>
<p><strong>I&#8217;ll be going through a couple of common techniques. Firstly I&#8217;ll introduce template matching and in the follow, using probabilistic recognition , then moving on to Machine learning applications such as using <span class="caps">BOW</span> models coupled with <span class="caps">SVM</span> , or feature extrapolation and recognition using neural&nbsp;nets.</strong></p>
<p><strong>Template based aproach</strong> 
Well, there are  a few contentions i;d like to make when we use this approach. Shape based approach is not the key or the best method for recognition. But , in industry, all methods have their perks. Say we have an industry converyor belt that is suppossed to carry only boxes or T- Joints or anything so simply extrapolable and uniform that it is feasible to use shape matching rather than going for complex approaches like using nets, or using <span class="caps">SVM</span> along with bag of words. Then I&#8217;d say, template matching or shape based matching is the best bet in terms of accuracy as well as&nbsp;speed. </p>
<p>Lets dive a little deeper in the aforementioned topic.
I&#8217;ll be using template matching as an example to explain how Shape based matching works. Consider two images. The template image (T) and the actual image (I). We say that we want to find the location / occurence of template inside the actual&nbsp;image.</p>
<p>In simple words I can say, return True, iff <span class="math">\(T \subseteq I\)</span>. But life aint so simple. In reality, every pixel needs to be iterated over and checked. It can be said that the a template is belonging to a particular image iff, all pixels match exactly. i.e. the sum of ( Absolute Difference between every pixel must be&nbsp;zero).</p>
<div class="math">$$SAD(x, y) = \sum_{i=0}^{T_{\text{rows}}}\sum_{j=0}^{T_{\text{cols}}} {\text{Diff}(x+i, y+j,i,j)}$$</div>
<p>Here&#8217;s how the above formula&nbsp;works.</p>
<p><span class="math">\(SAD\)</span> : sum of absolute differences.
<span class="math">\(SAD (x, y)\)</span> : the <span class="caps">SAD</span> of a particular pixel location in the actual Image <span class="math">\(I\)</span> </p>
<p>Each pixel in <span class="math">\(I\)</span> can be represented using <span class="math">\((x, y)\)</span>. It has an intensity, or color value expresed as <span class="math">\(Intensity(I(x,y))\)</span>.</p>
<p>Now, a pixel in template image <span class="math">\(T(p,q)\)</span> will have intensity as <span class="math">\(Intensity(T(p,q))\)</span>.</p>
<p>A search window is created that is of the size of template image. The window is then slid over the actual Image I and every time <span class="caps">SAD</span> is computed. For checking single occurence of template the iterations can be stopped once <span class="caps">SAD</span> is <span class="math">\(0\)</span>, or else it can be continued until the end of <span class="math">\(I\)</span> is&nbsp;reached. </p>
<p>We&#8217;ll be implementing the algorithm using opencv ,&nbsp;python </p>
<div class="gist">
    <script src='https://gist.github.com/c151fd726bb3d439b721b264f3d50843.js'></script>
    <noscript>
        <pre><code>"""
Template matching using opencv

Run : python file.py <templateImage> <actualImage>


"""

import sys, cv2
import numpy as np

def main(template, actualImage):
	tImage = cv2.imread(template, 0)
	aImage = cv2.imread(actualImage)
	aCopy = aImage.copy()
	aImage = cv2.cvtColor(aImage, cv2.COLOR_BGR2GRAY)
	th, tw = tImage.shape[:2]

	match = cv2.matchTemplate(aImage, tImage, cv2.TM_SQDIFF)
	minmaxlocs = cv2.minMaxLoc(match)
	topcorner = minmaxlocs[-2]
	bottomcorner=  (topcorner[0] + tw, topcorner[1]+th)
	cv2.rectangle(aCopy, topcorner, bottomcorner, (0, 0, 255), 2)

	cv2.imshow("actual Iamge", aCopy)
	cv2.waitKey()


if __name__ == '__main__':
	args = sys.argv[1:]
	print args
	if (len(args) is not 2):
		print "Please pass cmd args for template and actual image"
		sys.exit(-1)

	main(args[0], args[1])</code></pre>
    </noscript>
</div>
<p>Take a look at <span class="math">\(line 14\)</span>, it states <code>cv2.TM_SQDIFF</code> parameter in matchTemplate(). Opencv&#8217;s rendition for <span class="caps">SAD</span> can be delineated as&nbsp;: 
</p>
<div class="math">$$R(x, y) = \sum_{i, j}\ {(\text{T}(i,j) - \text{I}(x+i, y+j))^2}$$</div>
<p>And here is the output ! We will search a pair of glares from this paraphenalia
<center>
<img alt="crop" src="http://kushalvyas.github.io/images/tempCrop.jpg" /> </p>
<p><img alt="original" src="http://kushalvyas.github.io/images/optemplate.png" />
</center></p>
<p>Okay, so template matching can be established using the opencv api. Its&#8217; quite simple to implement in plain ol c++ as well. Not a biggie.  We&#8217;ll use the helper functions for image reading , accessing pixel value, etc. but the rest can be quite easily implemented using a bunch of <code>for loops</code></p>
<div class="gist">
    <script src='https://gist.github.com/0667c6a249f3397ee7de1db0cf04555d.js'></script>
    <noscript>
        <pre><code>/*
Author : Kushal Vyas
Code for template matching as implemented by opencv.

*/
#include "opencv2/imgproc/imgproc.hpp"
#include "opencv2/opencv.hpp"
#include "iostream"
#include "cmath"

using namespace std;
using namespace cv;

int main(){
	cout<<"Template matching \n";
	Mat tImage, aImage, aCopy;
	tImage = imread("tempCrop.jpg",0);
	aImage = imread("temA1.jpg",0);
	aCopy = imread("temA1.jpg");


	// performing template matching using SAD method
	Size Tsize, Isize ;
	Tsize = tImage.size();
	Isize = aImage.size();

	
	long int minSAD = 999999999999, SAD=0;
	int xloc=0, yloc=0, sadloc=0;
	// loop through the actual image
	int a_i, a_j;
	for (a_i =0; a_i < Isize.height - Tsize.height; a_i++){
		for (a_j=0; a_j < Isize.width - Tsize.width; a_j++){
			SAD = 0;

			// check every pixel of actual image with the template image
			// loop through the template image
			for(int t_j=0; t_j < Tsize.width; t_j++){
				for(int t_i=0; t_i < Tsize.height; t_i++){
					uchar aT = aImage.at<uchar>( a_i+t_i, a_j+t_j );
					uchar tT = tImage.at<uchar>(t_i, t_j);
					SAD += pow(abs(int(aT) - int(tT)),2);
				}
			}
			// cout <<"SASD sis "<<SAD<<endl; 
			// save the best found position
			if(minSAD > SAD ){
				cout <<" SAD "<< SAD<<endl;
				minSAD = SAD;
				yloc = a_i;
				xloc = a_j;
				sadloc = SAD;
			}
		}
	}

	cout<<"Template size"<<Tsize<<endl;
	cout<<"Image size"<<Isize<<endl;

	cout<<a_i<<" "<<a_j<<endl;

	cout<<xloc<<","<<yloc<<" SAD is "<<sadloc<<endl;

	// create a rectangle to demarkate the region
	rectangle(aCopy, Point(xloc, yloc), Point(xloc+Tsize.width, yloc+Tsize.height), Scalar(0,0,255), 2);

	// imshow("Template image", tImage);
	imshow("Actual image", aImage);
	imshow("Matched Image", aCopy);
	waitKey();
	destroyAllWindows();

	return 0;
}</code></pre>
    </noscript>
</div>
<p><em>You can find my remaining code on <a href="https://github.com/kushalvyas/ObjectDetectionPython">Github</a></em></p>
<p><strong> remaining posts on other approaches coming soon&nbsp;&#8230; </strong></p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' && location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
        </div>
    </section>
    <footer class="footer-article">
        <div class="tags-and-categories">Filed under <a href="http://kushalvyas.github.io/category/object-recognitioncv.html">Object Recognition,CV</a>
        | Tagged: <a href="http://kushalvyas.github.io/tag/objectrecognition.html">ObjectRecognition </a><a href="http://kushalvyas.github.io/tag/cv.html">CV </a>
        | <a href="http://kushalvyas.github.io/Obj_CV.html" rel="bookmark"
         title="Permalink to Simple Object Recognition techniques">Permalink</a>            
        </div>
        <!-- metaldata 
        -->
    </footer>
    <!-- disqus bitsmakemecrazy -->
        <hr>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = "bitsmakemecrazy"; // required: replace example with your forum shortname
            var disqus_identifier = "simple-object-recognition-techniques";
            var disqus_url = "http://kushalvyas.github.io/Obj_CV.html";
            var disqus_title = "Simple Object Recognition techniques";
            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
            </div>
         
            <div class="large-2 aside column" id="SIDEID">
         
                <!-- <h3>Trending</h3>
                <ul>

                    <li><a href="http://kushalvyas.github.io/BOV.html#BOV">Bag of Visual Words</a></li>

                    <li><a href="http://kushalvyas.github.io/gen_8Q.html">8 Queens GA</a></li>

                    <li><a href="http://kushalvyas.github.io/wiki_lookup.html">Wiki Lookup</a></li>
                </ul>
                <h3>Coming Soon</h3>
                <ul>
                        <li><a href="#" onclick="executeComingSoonPopUp();">Neural Style Evolution !</a></li>
                </ul> -->
            </div>
            <script>
                function load_sideID(){
                    var curr_url=  document.URL;
                    if(curr_url.indexOf('projects')>0){
                        console.log("on project page");
                    }else{
                        console.log("not on project page");
                        var side= $("#SIDEID");
                        var data = "<h3>Trending</h3>";
                        data += "<ul>";
                           data += '<li><a href="http://kushalvyas.github.io/BOV.html#BOV">Bag of Visual Words</a></li>';
                           data += '<li><a href="http://kushalvyas.github.io/gen_8Q.html">8 Queens GA</a></li>';
                           data += '<li><a href="http://kushalvyas.github.io/wiki_lookup.html">Wiki Lookup</a></li>';
                        data += "</ul>";

                        data +="<h3>Coming Soon</h3>";
                        data+="<ul>";
                            data+='<li><a href="">Neural Style Evolution !</a></li>';
                        data += '</ul>';
                        side.append(data);
                    }
                }
                load_sideID();

            </script>
          
         </div>
    </div>
</div>
    <div class="footer">
        <div class="data-holder">
        <div class="row">
            <div class="large-3 column">
<div class="credits">
    <h3>Stuff and credits</h3>
    <p>
    Proudly powered by <a href="http://getpelican.com/" target="_blank">Pelican</a>, 
    which takes great advantage of <a href="http://python.org" target="_blank">Python</a>.
    </p>
    <p>Theme is a modified Pelican Bricks</p>
    <p>
    This site also makes use of <a href="http://foundation.zurb.com" target="_blank">Zurb Foundation Framework</a>
    and is typeset using the blocky -- but quite good-looking indeed -- 
    <a href="https://www.google.com/fonts/specimen/Exo%202" target="_blank">Exo 2</a> fonts,
    which comes in a lot of weight and styles. 
    </p>
    <p>Enjoy!</a>
</div>           </div>
           <div class="large-6 tag-cloud column">
                <h3>Tags</h3>
                <ul>
                    <li><a href="http://kushalvyas.github.io/tag/ai.html">AI</a>(1)</li>
                    <li><a href="http://kushalvyas.github.io/tag/utils.html">utils</a>(1)</li>
                    <li><a href="http://kushalvyas.github.io/tag/py.html">Py</a>(1)</li>
                    <li><a href="http://kushalvyas.github.io/tag/wikipedia.html">wikipedia</a>(1)</li>
                    <li><a href="http://kushalvyas.github.io/tag/dev.html">dev</a>(1)</li>
                    <li><a href="http://kushalvyas.github.io/tag/technical.html">technical</a>(1)</li>
                    <li><a href="http://kushalvyas.github.io/tag/cv.html">CV</a>(3)</li>
                    <li><a href="http://kushalvyas.github.io/tag/objectrecognition.html">ObjectRecognition</a>(2)</li>
                </ul>
            </div>
            <div class="large-3 category-column column">
                <h3>Categories</h3>
                <ul>
                    <li><a href="http://kushalvyas.github.io/category/ai.html">AI</a> (1)</li>
                    <li><a href="http://kushalvyas.github.io/category/cv.html">CV</a> (2)</li>
                    <li><a href="http://kushalvyas.github.io/category/graph_py.html">graph_py</a> (1)</li>
                    <li><a href="http://kushalvyas.github.io/category/networks.html">networks</a> (1)</li>
                    <li><a href="http://kushalvyas.github.io/category/object-recognition-classification-cv.html">Object Recognition, Classification, CV</a> (1)</li>
                    <li class="active"><a href="http://kushalvyas.github.io/category/object-recognitioncv.html">Object Recognition,CV</a> (1)</li>
                    <li><a href="http://kushalvyas.github.io/category/technical-dev.html">technical, dev</a> (1)</li>
                    <li><a href="http://kushalvyas.github.io/category/utils.html">utils</a> (1)</li>
                </ul>
             
            </div>
        </row>
        </div>
    </div>

</body>
</html>